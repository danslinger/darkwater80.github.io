function loadTradeModule(){if(isUserLoggedIn&&tradeViewPermission){jQuery("#rosterTradeLinkDIV").show();var a=1e3*currentServerTime+6048e5,b=new Date(a);jQuery("#proposeTradeForm").attr("action",baseURLDynamic+"/"+year+"/trade_offer"),jQuery("#LEAGUE_ID").val(league_id),jQuery("#TRADE_EXPIRES_MONTH").val(b.getMonth()),jQuery("#TRADE_EXPIRES_DAY").val(b.getDate()),jQuery("#TRADE_EXPIRES_YEAR").val(b.getFullYear())}}function doShowAssets(a,b){a?(b==middleFranchise?$("#"+b+"_m #roster_assets tr").removeClass("assetsCollapsed"):$("#"+b+" #roster_assets tr").removeClass("assetsCollapsed"),$("#hideAssets_"+b).removeAttr("style"),$("#showAssets_"+b).attr("style","display:none")):(b==middleFranchise?$("#"+b+"_m #roster_assets tr").addClass("assetsCollapsed"):$("#"+b+" #roster_assets tr").addClass("assetsCollapsed"),$("#hideAssets_"+b).attr("style","display:none"),$("#showAssets_"+b).removeAttr("style"))}function checkTradeDeadline(){try{for(var a=0;a<calendarJson1.calendar.event.length;a++)if("TRADE"==calendarJson1.calendar.event[a].type){var b=parseInt(calendarJson1.calendar.event[a].start_time,10),c=parseInt(calendarJson1.calendar.event[a].end_time,10),d=parseInt(calendarJson1.calendar.event[a].happens,10);isNaN(c)&&(c=0),isNaN(d)?d=1:d+=1;for(var e=0;e<d;e++){var f=60*e*60*24*7+b;if(0==c)var g=0;else var g=60*e*60*24*7+c;(currentServerTime>f&&0==g||currentServerTime>f&&ServerTime<=g)&&(tradeDeadlinePassed=!0,$("#tradeViewTab").attr("disabled","disabled"),$("#tradeViewTab").parent().append("<span id='deadlinePassed' class='warning' style='position:absolute; padding-top:3px'>Trade Deadline has Passed!</span>"),$("#tradeViewTab").addClass("buttonDisabled"))}}}catch(h){}}function appendAssetResults(){var a=new Array;try{for(var b=0;b<assetJson1.assets.franchise.length;b++){var c=assetJson1.assets.franchise[b].id;a["fid_"+c]="<tr class='assets rosterView'><th colspan='9'>Other Assets (<a class='hideShowAssets' id='showAssets_"+c+"' onclick='doShowAssets(true,\""+c+"\")'>show</a><a class='hideShowAssets' id='hideAssets_"+c+"' style='display:none' onclick='doShowAssets(false,\""+c+"\");'>hide</a>)</th></tr>";var d=0;try{for(var e=0;e<assetJson1.assets.franchise[b].currentYearDraftPicks.draftPick.length;e++){if(d%2)var f=" eventablerow";else var f=" oddtablerow";a["fid_"+c]+="<tr class='assets rosterView assetsCollapsed"+f+"'><td align='center'><input type='checkbox' name='drop"+c+"' value='"+assetJson1.assets.franchise[b].currentYearDraftPicks.draftPick[e].pick+"'></td><td colspan='8' style='text-align:left'>"+assetJson1.assets.franchise[b].currentYearDraftPicks.draftPick[e].description+"</td></tr>",d++}}catch(g){console.log("assets error 2")}try{for(var h=!0,e=0;e<assetJson1.assets.franchise[b].futureYearDraftPicks.draftPick.length;e++){if(d%2)var f=" eventablerow";else var f=" oddtablerow";if(h)var i=" newposition";else var i="";a["fid_"+c]+="<tr class='assets rosterView assetsCollapsed"+f+i+"'><td align='center'><input type='checkbox' name='drop"+c+"' value='"+assetJson1.assets.franchise[b].futureYearDraftPicks.draftPick[e].pick+"'></td><td colspan='8' style='text-align:left'>"+assetJson1.assets.franchise[b].futureYearDraftPicks.draftPick[e].description+"</td></tr>",d++,h=!1}}catch(g){console.log("assets error 3")}try{if(parseFloat(assetJson1.assets.franchise[b].blindBiddingDollars.amount)>0){var h=!0;if(d%2)var f=" eventablerow";else var f=" oddtablerow";if(h)var i=" newposition";else var i="";a["fid_"+c]+="<tr class='assets rosterView assetsCollapsed"+f+i+"'><td align='center'><input type='text' name='bbid"+c+"' size='5' maxlength='10' value></td><td colspan='8' style='text-align:left'>Blind Bidding Dollars ($"+assetJson1.assets.franchise[b].blindBiddingDollars.amount+")</td></tr>",d++,h=!1}}catch(g){console.log("assets error 3")}c==middleFranchise?$("#"+c+"_m #roster_assets tbody").append(a["fid_"+c]):$("#"+c+" #roster_assets tbody").append(a["fid_"+c])}}catch(g){console.log("assets error 1")}}function displayRosterResults(){var a="",b="";if(b=createColumnMiddle(),a=createColumnLeft(rosterJson1.rosters.franchise),jQuery("#roster_column_left").html(a),isUserLoggedIn){for(var d=0;""!=middleFranchise&&d<rosterJson1.rosters.franchise.length;d++)if(middleFranchise!=rosterJson1.rosters.franchise[d].id){populateSelectedFranchise(rosterJson1.rosters.franchise[d].id);break}}else populateSelectedFranchise(rosterJson1.rosters.franchise[1].id)}function createColumnLeft(a){for(var b="<table>",c="</table>",d="",e=0;null!=a&&e<a.length;e++)if(""==middleFranchise||a[e].id!=middleFranchise){var f=franchiseDatabase["fid_"+a[e].id];if(f instanceof Franchise){d+='<tr class="left_m" id="left_menu_'+f.id+'">';var g="";useIcons?(d+="<td>",g=null==f.icon||""==f.icon.trim()?f.name:'<img src="'+f.icon+'"class="franchiseicon" title="'+f.name+'" />'):(d+='<td class="teamname" style="padding:5px 2px;padding:0.313rem 0.125rem;">',g=f.name),d=d+"<a href=\"javascript:populateSelectedFranchise('"+f.id+"')\">"+g+"</a>",d+="</td></tr>"}}return b+d+c}function populateSelectedFranchise(a){jQuery("#roster_column_right div").hide(),jQuery("#"+a).toggle()}function createColumnMiddle(){middleFranchise=isUserLoggedIn?"0000"==franchise_id?"undefined"!=typeof commishFranId&&""!=commishFranId&&"0000"!=commishFranId?commishFranId:rosterJson1.rosters.franchise[0].id:franchise_id:rosterJson1.rosters.franchise[0].id,jQuery("#roster_column_middle div").hide(),jQuery("#"+middleFranchise+"_m").show()}function getRosterModuleForFranchiseId(a){var b=jQuery("#"+a).html();return b}function setFranchiseIdForCommish(){for(var a=0;null!=leagueJson1.league.franchises.franchise&&void 0!=leagueJson1.league.franchises.franchise&&a<leagueJson1.league.franchises.franchise.length;a++)if(void 0!=leagueJson1.league.franchises.franchise[a].iscommish&&"1"==leagueJson1.league.franchises.franchise[a].iscommish){commishFranId=leagueJson1.league.franchises.franchise[a].id;break}}function getURLForCalendar(){return"/"+window.year+"/export?TYPE=calendar&L="+window.league_id+"&JSON=1"}function getURLForAssets(){return"/"+window.year+"/export?TYPE=assets&L="+window.league_id+"&JSON=1"}function getURLForRoster(){return"/"+window.year+"/export?TYPE=rosters&L="+window.league_id+"&JSON=1"}function getURLForLeague(){return"/"+window.year+"/export?TYPE=league&L="+window.league_id+"&W=&JSON=1"}function getAssetDataFromAjax(a){$.ajax({url:a,success:function(a){assetJson1=a},async:!1})}function getCalendarDataFromAjax(a){$.ajax({url:a,success:function(a){calendarJson1=a},async:!1})}function getRosterDataFromAjax(a){$.ajax({url:a,success:function(a){rosterJson1=a},async:!1})}function getLeagueDataFromAjax(a){$.ajax({url:a,success:function(a){leagueJson1=a},async:!1})}function proposeTrade(){tradeAction("Perform")}function performTrade(){tradeAction("Propose")}function tradeAction(a){{var c=(jQuery("#roster_column_middle input:checkbox:checked"),jQuery("#roster_column_right div:visible").attr("id"));jQuery("#roster_column_right #"+c+" input:checkbox:checked")}if(validateTradeForm()){jQuery("#roster_column_right div:not(:visible) input:checkbox").prop("checked",!1),jQuery("#FRANCHISE_ID").val(middleFranchise+","+c),jQuery("#roster_column_middle input:checkbox:checked").attr("name","drop"+middleFranchise),jQuery("#roster_column_right input:checkbox:checked").attr("name","drop"+c);var e=jQuery("#proposeTradeForm").attr("action");return e=e+"?"+a+"="+jQuery("name="+a).val(),jQuery("#proposeTradeForm").attr("action",e),jQuery("#proposeTradeForm").submit(),!0}}function showRosterDetails(){jQuery("#MFLroster  .checkBox").remove()}function showTradeDetails(){jQuery("#MFLroster  .player+th").parent().prepend('<th class="checkBox" align="center">Trade</td>'),jQuery("#MFLroster  .player+td").parent().each(function(){for(var c=$(this).children().eq(0).children().eq(0).attr("href").split("&"),d=0;d<c.length;d++){var e=c[d].split("=");"P"==e[0]&&$(this).prepend('<td class="checkBox" align="center"><input type="checkbox" value="'+e[1]+'" name=""></td>')}})}function tradeViewClickFunction(){jQuery("#tradeViewTab").hasClass("currenttab")||($(".assets").removeClass("rosterView"),showTradeDetails(),jQuery("#propseTradeButtonDIV").show(),jQuery("#tradeViewTab").addClass("currenttab"),jQuery("#rosterViewTab").removeClass("currenttab"),jQuery("#MFLroster  *#roster tr:not(:has(input:checkbox))").hide(),jQuery("#roster_column_middle div:visible tr").eq(0).show(),jQuery("#roster_column_right div").each(function(){var a=jQuery("tr");$(this).find(a).eq(0).show()}),jQuery("#messageBoxDIV").html('<table class="report" align="center"><caption><span>Trade Proposal</span></caption><tbody><tr><th>Optional Message to Include With Trade Offer Email:</th></tr><tr><td><textarea cols="70" rows="5" name="msg"></textarea></td></tr></tbody></table>'),"undefined"!=typeof franchise_id&&""!=franchise_id&&"0000"==franchise_id&&jQuery("[name=Perform]").show())}function rosterViewClickFunction(){jQuery("#rosterViewTab").hasClass("currenttab")||($(".assets").addClass("rosterView"),showRosterDetails(),jQuery("#propseTradeButtonDIV").hide(),jQuery("#MFLroster .checkBox").remove(),jQuery("#rosterViewTab").addClass("currenttab"),jQuery("#tradeViewTab").removeClass("currenttab"),jQuery("*#roster tr:not(:has(input:checkbox))").show(),jQuery("#messageBoxDIV").html(""))}function validateTradeForm(){return jQuery("#roster_column_right div:not(:visible) input:checkbox").prop("checked",!1),0==jQuery("#MFLroster input:checkbox:checked").length?(alert("Please select Players for trade"),!1):!0}function getPlayerProfileApiUrl(){return location.protocol+"//"+window.location.hostname}function appendFranchisesToColumns(){for(var a in franchiseDatabase)if(franchiseDatabase.hasOwnProperty(a)&&parseInt(franchiseDatabase[a].id)>0){var b=franchiseDatabase[a].id;$("#roster_column_middle").append('<div id="'+b+'_m" class="teamroster mobile-wrap" style="display:none">'+$("#rosterContainer"+b).html()+'<table class="homepagemodule report" id="roster_assets" style="padding-top:0" cellspacing="1" align="center"><tbody></tbody></table></div>'),$("#roster_column_right").append('<div id="'+b+'" class="teamroster mobile-wrap" style="display:none">'+$("#rosterContainer"+b).html()+'<table class="homepagemodule report" id="roster_assets" style="padding-top:0" cellspacing="1" align="center"><tbody></tbody></table></div>')}}function run_script(){$.when(getCalendarDataFromAjax(getURLForCalendar()),getLeagueDataFromAjax(getURLForLeague()),getRosterDataFromAjax(getURLForRoster()),getAssetDataFromAjax(getURLForAssets())).done(function(){checkTradeDeadline(),setFranchiseIdForCommish(),displayRosterResults(),appendAssetResults(),loadTradeModule()}),$("#home caption.withfranchiseicon img").on("mousedown",function(){return!1}),$("#btn_run").hide(),"0000"!=franchise_id&&void 0!=franchise_id&&varDeluxeleague&&($(".left_m").hide(),$.ajax({url:getPlayerProfileApiUrl()+"/%YEAR%/export?TYPE=league&L=%LEAGUEID%&W=&JSON=1",context:document.body}).done(function(a){if(void 0!=a.league.conferences){var b,e,c=a.league.franchises.franchise,d=a.league.divisions.division,f=",";for(i=0;i<c.length;i++)if(c[i].id==franchise_id){b=c[i].division;break}for(i=0;i<d.length;i++)if(d[i].id==b){e=d[i].conference;break}for(i=0;i<d.length;i++)d[i].conference==e&&(f+=d[i].id+",");for(i=0;i<c.length;i++)f.indexOf(","+c[i].division+",")>-1&&$("#left_menu_"+c[i].id).show()}else{var b,g=a.league.franchises.franchise;for(i=1;i<g.length;i++)if(g[i].id==franchise_id){b=g[i].division;break}for(i=1;i<g.length;i++)g[i].division==b&&$("#left_menu_"+g[i].id).show();console.log(b)}}))}function createHTML(){var a="";a+=' <form  method="post" id="proposeTradeForm">',a+='  <input type="hidden" id="LEAGUE_ID" name="LEAGUE_ID" value="" />',a+='  <input type="hidden" id="TRADE_EXPIRES_MONTH" name="TRADE_EXPIRES_MONTH" value="" />',a+='  <input type="hidden" id="TRADE_EXPIRES_DAY" name="TRADE_EXPIRES_DAY" value="" />',a+='  <input type="hidden" id="TRADE_EXPIRES_TIME" name="TRADE_EXPIRES_TIME" value="01" />',a+='  <input type="hidden" id="TRADE_EXPIRES_YEAR" name="TRADE_EXPIRES_YEAR" value="" />',a+='  <input type="hidden" id="FRANCHISE_ID" name="FRANCHISE_ID" value="" />',a+='  <div id="MFLroster">',a+='   <div id="rosterTradeLinkDIV" style="display:none;text-align:center">',a+='    <input id="rosterViewTab" class="currenttab" style="text-transform: uppercase;" value="Roster View" onclick="javascript:rosterViewClickFunction(); return false;" type="submit">',a+='    <input id="tradeViewTab" class="" style="text-transform: uppercase;" value="Trade View" onclick="javascript:tradeViewClickFunction(); return false;" type="submit">',a+="   </div>",a+='   <table align="center" style="table-layout:fixed">',a+="    <tr>",a+='     <td class="mobile-view icon_column" style="vertical-align:top">',a+='      <div id="roster_column_left"></div>',a+="     </td>",a+='     <td class="two_column" style="vertical-align:top">',a+='      <div id="roster_column_middle">',a+="      </div>",a+="     </td>",a+='     <td class="two_column" style="vertical-align:top">',a+='      <div id="roster_column_right">',a+="      </div>",a+="     </td>",a+="    </tr>",a+="   </table>",a+='   <div id="messageBoxDIV" class="mobile-wrap"></div>',a+='   <div id="propseTradeButtonDIV" style="display:none">',a+='    <p class="form_buttons">',a+='     <input type="submit" value="Perform Trade" style="display:none;text-transform:uppercase" name="Perform" onclick="javascript:performTrade(); return false;" />',a+='     <input type="submit" value="Propose Trade" style="text-transform:uppercase" name="Propose" onclick="javascript:proposeTrade(); return false;" />',a+="    </p>",a+="   </div>",a+="  </div>",a+=" </form>",a+="</div>",$("#pre_load_html").html(a),$(".mobile-wrap > #pre_load_html").unwrap(),appendFranchisesToColumns()}var isUserLoggedIn="undefined"===typeof franchise_id?!1:!0,rosterJson1="",leagueJson1="",assetJson1="",calendarJson1="",middleFranchise="",tradeDeadlinePassed=!1;if(void 0==SetCaptionIconWidth)var SetCaptionIconWidth=250;if(void 0==SetLeftColumnWidth)var SetLeftColumnWidth=150;if(void 0==useIcons)var useIcons=!0;if(void 0==varLoadRoster)var varLoadRoster=!0;if(void 0==tradeViewPermission)var tradeViewPermission=!0;if(void 0==varDeluxeleague)var varDeluxeleague=!1;if(void 0==RosterEnableMedia)var RosterEnableMedia=!0;$("head").append("<style>td.icon_column .franchiseicon{padding:0 5px;padding:0 .313rem;max-height:80px;max-height:5rem;display:block;margin:0 auto}#roster caption.withfranchiseicon .franchiseicon{height:auto;max-width:100%;max-height:80px;max-height:5rem}#rosterTradeLinkDIV input.currenttab{opacity:.5}#roster caption.withfranchiseicon{padding-left:3px;padding-left:.188rem;padding-right:3px;padding-right:.188rem}.rosterView{display:none}.assetsCollapsed td{display:none}.hideShowAssets{cursor:pointer}td.icon_column{width:"+SetLeftColumnWidth+"px;}td.icon_column .franchiseicon{max-width:"+SetLeftColumnWidth+"px;}#roster caption.withfranchiseicon .franchiseicon {width:100%;max-width:"+SetCaptionIconWidth+"px;}</style>"),RosterEnableMedia&&$("head").append("<style>@media only screen and (max-width: 62.5em){td.icon_column{padding:10px 0;padding:0.625rem 0;}#roster_column_left{overflow:auto;-webkit-overflow-scrolling:touch}#roster_column_left tr{display:table-cell}td.two_column{display:inline-table;width:49%}#MFLroster table{text-align:center}#roster th,#roster td{display:none}#roster .player,#roster .checkBox,#roster .points,#roster .week{display:table-cell}}@media only screen and (max-width: 40em){#roster caption{font-size:120%}#roster{font-size:90%}}@media only screen and (max-width: 34em){#roster caption{font-size:110%}#roster{font-size:80%}#roster caption span{background:none;padding:0}#roster caption{text-indent:0;padding-left:5px;padding-left:.313rem}#roster .points,#roster .week{display:none}}</style>"),$(document).ready(function(){createHTML(),varLoadRoster?run_script():$("#pre_load_html").before("<div id='btn_run' style='text-align:center' onclick='run_script()'><input style='text-transform: uppercase;' value='Click to view rosters' type='submit'></div>")});